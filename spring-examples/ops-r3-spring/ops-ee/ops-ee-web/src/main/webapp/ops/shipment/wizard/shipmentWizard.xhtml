<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.prime.com.tr/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:shipment="http://java.sun.com/jsf/composite/shipment"
      xmlns:address="http://java.sun.com/jsf/composite/address"
      xmlns:parcel="http://java.sun.com/jsf/composite/parcel"
      xmlns:shippingService="http://java.sun.com/jsf/composite/shippingService"

      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
    >
<h:head>
  <title>WIZZAARD</title>
</h:head>
<h:body>
<!--    <f:view>
-->
<ui:composition template="/templates/common/layout.xhtml">

<ui:define name="content">

<p:panel header="Create Shipment Wizard">
<h:form>
  <p:wizard widgetVar="wiz"
            flowListener="#{shipmentWizard.onFlowProcess}">

    <p:tab id="from_tab" title="From Address">
      <p:panel header="From Address">
        <h:messages errorClass="error"/>
        <address:gridInput address="#{shipmentWizard.fromAddress}" id="fromAddress_input"/>
      </p:panel>
    </p:tab>

    <p:tab id="to_tab" title="To Address">
      <p:panel header="To Address">
        <h:messages errorClass="error"/>
        <address:gridInput address="#{shipmentWizard.toAddress}" id="toAddress_input"/>
      </p:panel>
    </p:tab>

    <p:tab id="parcels_tab" title="Parcels">
      <p:panel id="parcels_panel" header="Parcels">

        <h:messages errorClass="error"/>

        <h:panelGrid id="wiz_step_grid" columns="2" columnClasses="label, value"
                     rowClasses="row-top-align">
          <h:panelGrid id="parcel_input_grid" columns="2" columnClasses="label, value">

            <h:outputText value="Contents: *"/>
            <p:inputText id="parcel_contents" value="#{shipmentWizard.parcelContents}"/>

            <h:outputText value="Weight: *"/>
            <p:inputText id="parcel_weight" value="#{shipmentWizard.parcelWeight}"/>

            <h:outputText value="Height: *"/>
            <p:inputText id="parcel_height" value="#{shipmentWizard.parcelHeight}"/>

            <h:outputText value="Width: *"/>
            <p:inputText id="parcel_width" value="#{shipmentWizard.parcelWidth}"/>

            <h:outputText value="Length: *"/>
            <p:inputText id="parcel_length" value="#{shipmentWizard.parcelLength}"/>

            <h:commandButton value="Add"
                             id="btn_add_parcel"
                             actionListener="#{shipmentWizard.addParcelActionListener}">
              <f:ajax execute="parcel_contents parcel_weight parcel_height parcel_width parcel_length"
                      render="parcel_dataTable parcel_contents parcel_weight parcel_height parcel_width parcel_length"/>
            </h:commandButton>

          </h:panelGrid>

          <h:dataTable value="#{shipmentWizard.parcelList}"
                       id="parcel_dataTable"
                       var="parcel"
                       styleClass="data-table"
                       headerClass="table-header"
                       rowClasses="row-odd,row-even"
                       columnClasses="column-center">

            <f:facet name="header">Parcels</f:facet>

            <h:column>
              <f:facet name="header">Contents</f:facet>
              <h:outputText value="#{parcel.contents}"/>
            </h:column>

            <h:column>
              <f:facet name="header">Weight</f:facet>
              <h:outputText value="#{parcel.weight}"/>
            </h:column>

            <h:column>
              <f:facet name="header">Height</f:facet>
              <h:outputText value="#{parcel.height}"/>
            </h:column>

            <h:column>
              <f:facet name="header">Width</f:facet>
              <h:outputText value="#{parcel.width}"/>
            </h:column>

            <h:column>
              <f:facet name="header">Length</f:facet>
              <h:outputText value="#{parcel.length}"/>
            </h:column>
          </h:dataTable>
        </h:panelGrid>
      </p:panel>
    </p:tab>

    <p:tab id="service_tab" title="Service">
      <p:panel id="service_panel" header="Service">

        <h:messages errorClass="error"/>

        <h:panelGrid id="wiz_step_service"
                     columns="2"
                     columnClasses="label, value"
                     rowClasses="row-top-align">

          <h:panelGrid id="service_panel_grid"
                       columns="2"
                       border="2">

            <h:selectOneRadio value="#{shipmentWizard.selectedService}"
                              id="select_one_service">

              <f:selectItems value="#{shipmentWizard.shippingServiceList}"
                             var="service"
                             itemLabel="#{service.name}"
                             itemValue="#{service}"/>
              <f:ajax render="form:all selected_service_rate" execute="selected_service_rate"/>
            </h:selectOneRadio>

            <h:panelGroup>
              <h:outputText value="Cost: "/>
              <h:outputText id="selected_service_rate" value="#{shipmentWizard.selectedService.cost}"/>
            </h:panelGroup>
          </h:panelGrid>
        </h:panelGrid>
      </p:panel>
    </p:tab>


    <p:tab id="confirm" title="Confirm">
      <p:panel id="confirmation_panel" header="Confirmation">

        <p:growl id="growl" sticky="true" showDetail="true"/>

        <h:panelGrid id="confirmationPanelGrid" columns="2">

          <h:panelGrid id="fromAddress_confirm"
                       columns="1"
                       headerClass="header-left">

            <f:facet name="header">
              <h:outputText value="From Address"/>
            </f:facet>
            <address:threeLine address="#{shipmentWizard.fromAddress}"/>
          </h:panelGrid>

          <h:panelGrid id="toAddress_confirm"
                       headerClass="header-left"
                       columns="1">

            <f:facet name="header">
              <h:outputText value="To Address"/>
            </f:facet>

            <address:threeLine address="#{shipmentWizard.toAddress}"/>
          </h:panelGrid>

          <parcel:dataTable dataTableId="parcelDataTable"
                            parcelList="#{shipmentWizard.parcelList}"/>
        </h:panelGrid>

        <p:commandButton id="refreshConfirmationPageBTN"
                         rendered="true"
                         value="Refresh"
                         widgetVar="refreshButton">
          <f:ajax render="confirmationPanelGrid"/>
        </p:commandButton>

        <p:commandButton value="Submit" update="growl"
                         widgetVar="submitButton"
                         onclick="confirmDialog.show()"/>

        <p:dialog modal="true"
                  header="Are you sure?"
                  widgetVar="confirmDialog"
                  hideEffect="fade" width="200">

          <p:commandButton value="Yes"
                           widgetVar="yesButton"
                           onclick="confirmDialog.hide()"
                           ajax="false"
                           action="#{shipmentWizard.finish}"/>

          <p:commandButton value="No"
                           widgetVar="noButton"
                           onclick="confirmDialog.hide()"/>
        </p:dialog>

      </p:panel>
    </p:tab>

  </p:wizard>

  <p:ajaxStatus>
    <f:facet name="start">
      <h:graphicImage value="/resources/images/ajaxloading.gif"/>
    </f:facet>

    <f:facet name="complete">
      <h:outputText value=""/>
    </f:facet>
  </p:ajaxStatus>

</h:form>

</p:panel>
</ui:define>

</ui:composition>

</h:body>
</html>